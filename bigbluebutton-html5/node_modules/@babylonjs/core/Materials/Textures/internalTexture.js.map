{"version":3,"file":"internalTexture.js","sourceRoot":"","sources":["../../../../sourceES6/core/Materials/Textures/internalTexture.ts"],"names":[],"mappings":"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","sourcesContent":["import { Observable } from \"../../Misc/observable\";\r\nimport { Nullable, int } from \"../../types\";\r\nimport { RenderTargetCreationOptions } from \"../../Materials/Textures/renderTargetCreationOptions\";\r\n\r\nimport { _DevTools } from '../../Misc/devTools';\r\nimport { Engine } from '../../Engines/engine';\r\n\r\ndeclare type ThinEngine = import(\"../../Engines/thinEngine\").ThinEngine;\r\ndeclare type BaseTexture = import(\"../../Materials/Textures/baseTexture\").BaseTexture;\r\ndeclare type SphericalPolynomial = import(\"../../Maths/sphericalPolynomial\").SphericalPolynomial;\r\n\r\n/**\r\n * Defines the source of the internal texture\r\n */\r\nexport enum InternalTextureSource {\r\n    /**\r\n     * The source of the texture data is unknown\r\n     */\r\n    Unknown,\r\n    /**\r\n    * Texture data comes from an URL\r\n    */\r\n    Url,\r\n    /**\r\n     * Texture data is only used for temporary storage\r\n     */\r\n    Temp,\r\n    /**\r\n     * Texture data comes from raw data (ArrayBuffer)\r\n     */\r\n    Raw,\r\n    /**\r\n     * Texture content is dynamic (video or dynamic texture)\r\n     */\r\n    Dynamic,\r\n    /**\r\n     * Texture content is generated by rendering to it\r\n     */\r\n    RenderTarget,\r\n    /**\r\n     * Texture content is part of a multi render target process\r\n     */\r\n    MultiRenderTarget,\r\n    /**\r\n     * Texture data comes from a cube data file\r\n     */\r\n    Cube,\r\n    /**\r\n     * Texture data comes from a raw cube data\r\n     */\r\n    CubeRaw,\r\n    /**\r\n     * Texture data come from a prefiltered cube data file\r\n     */\r\n    CubePrefiltered,\r\n    /**\r\n     * Texture content is raw 3D data\r\n     */\r\n    Raw3D,\r\n    /**\r\n     * Texture content is raw 2D array data\r\n     */\r\n    Raw2DArray,\r\n    /**\r\n     * Texture content is a depth texture\r\n     */\r\n    Depth,\r\n    /**\r\n     * Texture data comes from a raw cube data encoded with RGBD\r\n     */\r\n    CubeRawRGBD\r\n}\r\n\r\n/**\r\n * Class used to store data associated with WebGL texture data for the engine\r\n * This class should not be used directly\r\n */\r\nexport class InternalTexture {\r\n\r\n    /** @hidden */\r\n    public static _UpdateRGBDAsync = (internalTexture: InternalTexture, data: ArrayBufferView[][], sphericalPolynomial: Nullable<SphericalPolynomial>, lodScale: number, lodOffset: number): Promise<void> => {\r\n        throw _DevTools.WarnImport(\"environmentTextureTools\");\r\n    }\r\n\r\n    /**\r\n     * Defines if the texture is ready\r\n     */\r\n    public isReady: boolean = false;\r\n    /**\r\n     * Defines if the texture is a cube texture\r\n     */\r\n    public isCube: boolean = false;\r\n    /**\r\n     * Defines if the texture contains 3D data\r\n     */\r\n    public is3D: boolean = false;\r\n    /**\r\n     * Defines if the texture contains 2D array data\r\n     */\r\n    public is2DArray: boolean = false;\r\n    /**\r\n     * Defines if the texture contains multiview data\r\n     */\r\n    public isMultiview: boolean = false;\r\n    /**\r\n     * Gets the URL used to load this texture\r\n     */\r\n    public url: string = \"\";\r\n    /**\r\n     * Gets the sampling mode of the texture\r\n     */\r\n    public samplingMode: number = -1;\r\n    /**\r\n     * Gets a boolean indicating if the texture needs mipmaps generation\r\n     */\r\n    public generateMipMaps: boolean = false;\r\n    /**\r\n     * Gets the number of samples used by the texture (WebGL2+ only)\r\n     */\r\n    public samples: number = 0;\r\n    /**\r\n     * Gets the type of the texture (int, float...)\r\n     */\r\n    public type: number = -1;\r\n    /**\r\n     * Gets the format of the texture (RGB, RGBA...)\r\n     */\r\n    public format: number = -1;\r\n    /**\r\n     * Observable called when the texture is loaded\r\n     */\r\n    public onLoadedObservable = new Observable<InternalTexture>();\r\n    /**\r\n     * Gets the width of the texture\r\n     */\r\n    public width: number = 0;\r\n    /**\r\n     * Gets the height of the texture\r\n     */\r\n    public height: number = 0;\r\n    /**\r\n     * Gets the depth of the texture\r\n     */\r\n    public depth: number = 0;\r\n    /**\r\n     * Gets the initial width of the texture (It could be rescaled if the current system does not support non power of two textures)\r\n     */\r\n    public baseWidth: number = 0;\r\n    /**\r\n     * Gets the initial height of the texture (It could be rescaled if the current system does not support non power of two textures)\r\n     */\r\n    public baseHeight: number = 0;\r\n    /**\r\n     * Gets the initial depth of the texture (It could be rescaled if the current system does not support non power of two textures)\r\n     */\r\n    public baseDepth: number = 0;\r\n    /**\r\n     * Gets a boolean indicating if the texture is inverted on Y axis\r\n     */\r\n    public invertY: boolean = false;\r\n\r\n    // Private\r\n    /** @hidden */\r\n    public _invertVScale = false;\r\n    /** @hidden */\r\n    public _associatedChannel = -1;\r\n    /** @hidden */\r\n    public _source = InternalTextureSource.Unknown;\r\n    /** @hidden */\r\n    public _buffer: Nullable<string | ArrayBuffer | ArrayBufferView | HTMLImageElement | Blob | ImageBitmap> = null;\r\n    /** @hidden */\r\n    public _bufferView: Nullable<ArrayBufferView> = null;\r\n    /** @hidden */\r\n    public _bufferViewArray: Nullable<ArrayBufferView[]> = null;\r\n    /** @hidden */\r\n    public _bufferViewArrayArray: Nullable<ArrayBufferView[][]> = null;\r\n    /** @hidden */\r\n    public _size: number = 0;\r\n    /** @hidden */\r\n    public _extension: string = \"\";\r\n    /** @hidden */\r\n    public _files: Nullable<string[]> = null;\r\n    /** @hidden */\r\n    public _workingCanvas: Nullable<HTMLCanvasElement | OffscreenCanvas> = null;\r\n    /** @hidden */\r\n    public _workingContext: Nullable<CanvasRenderingContext2D | OffscreenCanvasRenderingContext2D> = null;\r\n    /** @hidden */\r\n    public _framebuffer: Nullable<WebGLFramebuffer> = null;\r\n    /** @hidden */\r\n    public _depthStencilBuffer: Nullable<WebGLRenderbuffer> = null;\r\n    /** @hidden */\r\n    public _MSAAFramebuffer: Nullable<WebGLFramebuffer> = null;\r\n    /** @hidden */\r\n    public _MSAARenderBuffer: Nullable<WebGLRenderbuffer> = null;\r\n    /** @hidden */\r\n    public _attachments: Nullable<number[]> = null;\r\n    /** @hidden */\r\n    public _cachedCoordinatesMode: Nullable<number> = null;\r\n    /** @hidden */\r\n    public _cachedWrapU: Nullable<number> = null;\r\n    /** @hidden */\r\n    public _cachedWrapV: Nullable<number> = null;\r\n    /** @hidden */\r\n    public _cachedWrapR: Nullable<number> = null;\r\n    /** @hidden */\r\n    public _cachedAnisotropicFilteringLevel: Nullable<number> = null;\r\n    /** @hidden */\r\n    public _isDisabled: boolean = false;\r\n    /** @hidden */\r\n    public _compression: Nullable<string> = null;\r\n    /** @hidden */\r\n    public _generateStencilBuffer: boolean = false;\r\n    /** @hidden */\r\n    public _generateDepthBuffer: boolean = false;\r\n    /** @hidden */\r\n    public _comparisonFunction: number = 0;\r\n    /** @hidden */\r\n    public _sphericalPolynomial: Nullable<SphericalPolynomial> = null;\r\n    /** @hidden */\r\n    public _lodGenerationScale: number = 0;\r\n    /** @hidden */\r\n    public _lodGenerationOffset: number = 0;\r\n    /** @hidden */\r\n    public _depthStencilTexture: Nullable<InternalTexture>;\r\n\r\n    // Multiview\r\n    /** @hidden */\r\n    public _colorTextureArray: Nullable<WebGLTexture> = null;\r\n    /** @hidden */\r\n    public _depthStencilTextureArray: Nullable<WebGLTexture> = null;\r\n\r\n    // The following three fields helps sharing generated fixed LODs for texture filtering\r\n    // In environment not supporting the textureLOD extension like EDGE. They are for internal use only.\r\n    // They are at the level of the gl texture to benefit from the cache.\r\n    /** @hidden */\r\n    public _lodTextureHigh: Nullable<BaseTexture> = null;\r\n    /** @hidden */\r\n    public _lodTextureMid: Nullable<BaseTexture> = null;\r\n    /** @hidden */\r\n    public _lodTextureLow: Nullable<BaseTexture> = null;\r\n    /** @hidden */\r\n    public _isRGBD: boolean = false;\r\n\r\n    /** @hidden */\r\n    public _linearSpecularLOD: boolean = false;\r\n    /** @hidden */\r\n    public _irradianceTexture: Nullable<BaseTexture> = null;\r\n\r\n    /** @hidden */\r\n    public _webGLTexture: Nullable<WebGLTexture> = null;\r\n    /** @hidden */\r\n    public _references: number = 1;\r\n\r\n    private _engine: ThinEngine;\r\n\r\n    /**\r\n     * Gets the Engine the texture belongs to.\r\n     * @returns The babylon engine\r\n     */\r\n    public getEngine(): ThinEngine {\r\n        return this._engine;\r\n    }\r\n\r\n    /**\r\n     * Gets the data source type of the texture\r\n     */\r\n    public get source(): InternalTextureSource {\r\n        return this._source;\r\n    }\r\n\r\n    /**\r\n     * Creates a new InternalTexture\r\n     * @param engine defines the engine to use\r\n     * @param source defines the type of data that will be used\r\n     * @param delayAllocation if the texture allocation should be delayed (default: false)\r\n     */\r\n    constructor(engine: ThinEngine, source: InternalTextureSource, delayAllocation = false) {\r\n        this._engine = engine;\r\n        this._source = source;\r\n\r\n        if (!delayAllocation) {\r\n            this._webGLTexture = engine._createTexture();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Increments the number of references (ie. the number of Texture that point to it)\r\n     */\r\n    public incrementReferences(): void {\r\n        this._references++;\r\n    }\r\n\r\n    /**\r\n     * Change the size of the texture (not the size of the content)\r\n     * @param width defines the new width\r\n     * @param height defines the new height\r\n     * @param depth defines the new depth (1 by default)\r\n     */\r\n    public updateSize(width: int, height: int, depth: int = 1): void {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.depth = depth;\r\n\r\n        this.baseWidth = width;\r\n        this.baseHeight = height;\r\n        this.baseDepth = depth;\r\n\r\n        this._size = width * height * depth;\r\n    }\r\n\r\n    /** @hidden */\r\n    public _rebuild(): void {\r\n        var proxy: InternalTexture;\r\n        this.isReady = false;\r\n        this._cachedCoordinatesMode = null;\r\n        this._cachedWrapU = null;\r\n        this._cachedWrapV = null;\r\n        this._cachedAnisotropicFilteringLevel = null;\r\n\r\n        switch (this.source) {\r\n            case InternalTextureSource.Temp:\r\n                return;\r\n\r\n            case InternalTextureSource.Url:\r\n                proxy = this._engine.createTexture(this.url, !this.generateMipMaps, this.invertY, null, this.samplingMode, () => {\r\n                    proxy._swapAndDie(this);\r\n                    this.isReady = true;\r\n                }, null, this._buffer, undefined, this.format);\r\n                return;\r\n\r\n            case InternalTextureSource.Raw:\r\n                proxy = this._engine.createRawTexture(this._bufferView, this.baseWidth, this.baseHeight, this.format, this.generateMipMaps,\r\n                    this.invertY, this.samplingMode, this._compression);\r\n                proxy._swapAndDie(this);\r\n\r\n                this.isReady = true;\r\n                return;\r\n\r\n            case InternalTextureSource.Raw3D:\r\n                proxy = this._engine.createRawTexture3D(this._bufferView, this.baseWidth, this.baseHeight, this.baseDepth, this.format, this.generateMipMaps,\r\n                    this.invertY, this.samplingMode, this._compression);\r\n                proxy._swapAndDie(this);\r\n\r\n                this.isReady = true;\r\n                return;\r\n\r\n            case InternalTextureSource.Raw2DArray:\r\n                proxy = this._engine.createRawTexture2DArray(this._bufferView, this.baseWidth, this.baseHeight, this.baseDepth, this.format, this.generateMipMaps,\r\n                    this.invertY, this.samplingMode, this._compression);\r\n                proxy._swapAndDie(this);\r\n\r\n                this.isReady = true;\r\n                return;\r\n\r\n            case InternalTextureSource.Dynamic:\r\n                proxy = this._engine.createDynamicTexture(this.baseWidth, this.baseHeight, this.generateMipMaps, this.samplingMode);\r\n                proxy._swapAndDie(this);\r\n                this._engine.updateDynamicTexture(this, this._engine.getRenderingCanvas()!, this.invertY, undefined, undefined, true);\r\n\r\n                // The engine will make sure to update content so no need to flag it as isReady = true\r\n                return;\r\n\r\n            case InternalTextureSource.RenderTarget:\r\n                let options = new RenderTargetCreationOptions();\r\n                options.generateDepthBuffer = this._generateDepthBuffer;\r\n                options.generateMipMaps = this.generateMipMaps;\r\n                options.generateStencilBuffer = this._generateStencilBuffer;\r\n                options.samplingMode = this.samplingMode;\r\n                options.type = this.type;\r\n\r\n                if (this.isCube) {\r\n                    proxy = this._engine.createRenderTargetCubeTexture(this.width, options);\r\n                } else {\r\n                    let size = {\r\n                        width: this.width,\r\n                        height: this.height,\r\n                        layers: this.is2DArray ? this.depth : undefined\r\n                    };\r\n\r\n                    proxy = (this._engine as Engine).createRenderTargetTexture(size, options);\r\n                }\r\n                proxy._swapAndDie(this);\r\n\r\n                this.isReady = true;\r\n                return;\r\n            case InternalTextureSource.Depth:\r\n                let depthTextureOptions = {\r\n                    bilinearFiltering: this.samplingMode !== 2,\r\n                    comparisonFunction: this._comparisonFunction,\r\n                    generateStencil: this._generateStencilBuffer,\r\n                    isCube: this.isCube\r\n                };\r\n\r\n                let size = {\r\n                    width: this.width,\r\n                    height: this.height,\r\n                    layers: this.is2DArray ? this.depth : undefined\r\n                };\r\n                proxy = this._engine.createDepthStencilTexture(size, depthTextureOptions);\r\n                proxy._swapAndDie(this);\r\n\r\n                this.isReady = true;\r\n                return;\r\n\r\n            case InternalTextureSource.Cube:\r\n                proxy = this._engine.createCubeTexture(this.url, null, this._files, !this.generateMipMaps, () => {\r\n                    proxy._swapAndDie(this);\r\n                    this.isReady = true;\r\n                }, null, this.format, this._extension);\r\n                return;\r\n\r\n            case InternalTextureSource.CubeRaw:\r\n                proxy = this._engine.createRawCubeTexture(this._bufferViewArray!, this.width, this.format, this.type, this.generateMipMaps, this.invertY, this.samplingMode, this._compression);\r\n                proxy._swapAndDie(this);\r\n                this.isReady = true;\r\n                return;\r\n\r\n            case InternalTextureSource.CubeRawRGBD:\r\n                proxy = this._engine.createRawCubeTexture(null, this.width, this.format, this.type, this.generateMipMaps, this.invertY, this.samplingMode, this._compression);\r\n                InternalTexture._UpdateRGBDAsync(proxy, this._bufferViewArrayArray!, this._sphericalPolynomial, this._lodGenerationScale, this._lodGenerationOffset).then(() => {\r\n                    proxy._swapAndDie(this);\r\n                    this.isReady = true;\r\n                });\r\n                return;\r\n\r\n            case InternalTextureSource.CubePrefiltered:\r\n                proxy = this._engine.createPrefilteredCubeTexture(this.url, null, this._lodGenerationScale, this._lodGenerationOffset, (proxy) => {\r\n                    if (proxy) {\r\n                        proxy._swapAndDie(this);\r\n                    }\r\n\r\n                    this.isReady = true;\r\n                }, null, this.format, this._extension);\r\n                proxy._sphericalPolynomial = this._sphericalPolynomial;\r\n                return;\r\n        }\r\n    }\r\n\r\n    /** @hidden */\r\n    public _swapAndDie(target: InternalTexture): void {\r\n        target._webGLTexture = this._webGLTexture;\r\n        target._isRGBD = this._isRGBD;\r\n\r\n        if (this._framebuffer) {\r\n            target._framebuffer = this._framebuffer;\r\n        }\r\n\r\n        if (this._depthStencilBuffer) {\r\n            target._depthStencilBuffer = this._depthStencilBuffer;\r\n        }\r\n\r\n        target._depthStencilTexture = this._depthStencilTexture;\r\n\r\n        if (this._lodTextureHigh) {\r\n            if (target._lodTextureHigh) {\r\n                target._lodTextureHigh.dispose();\r\n            }\r\n            target._lodTextureHigh = this._lodTextureHigh;\r\n        }\r\n\r\n        if (this._lodTextureMid) {\r\n            if (target._lodTextureMid) {\r\n                target._lodTextureMid.dispose();\r\n            }\r\n            target._lodTextureMid = this._lodTextureMid;\r\n        }\r\n\r\n        if (this._lodTextureLow) {\r\n            if (target._lodTextureLow) {\r\n                target._lodTextureLow.dispose();\r\n            }\r\n            target._lodTextureLow = this._lodTextureLow;\r\n        }\r\n\r\n        if (this._irradianceTexture) {\r\n            if (target._irradianceTexture) {\r\n                target._irradianceTexture.dispose();\r\n            }\r\n            target._irradianceTexture = this._irradianceTexture;\r\n        }\r\n\r\n        let cache = this._engine.getLoadedTexturesCache();\r\n        var index = cache.indexOf(this);\r\n        if (index !== -1) {\r\n            cache.splice(index, 1);\r\n        }\r\n\r\n        var index = cache.indexOf(target);\r\n        if (index === -1) {\r\n            cache.push(target);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Dispose the current allocated resources\r\n     */\r\n    public dispose(): void {\r\n        if (!this._webGLTexture) {\r\n            return;\r\n        }\r\n\r\n        this._references--;\r\n        if (this._references === 0) {\r\n            this._engine._releaseTexture(this);\r\n            this._webGLTexture = null;\r\n        }\r\n    }\r\n}\r\n"]}